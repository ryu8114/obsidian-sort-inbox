---
description: 
globs: 
alwaysApply: true
---

# ✅ Obsidian プラグイン：AIメモ分類プロジェクト（Gemini 2.0 Flash 使用）

## 1. 🎯 プロジェクトの目的

- `メモ/` フォルダ直下に作成された `.md` ファイルを、自動で分類対象フォルダに移動する。
- 分類は「タイトル＋本文」の内容を Gemini 2.0 Flash に送って判断させる。
- **該当するフォルダがない場合は、移動・分類しない（スキップ）**。
- 分類対象のフォルダは、**ユーザーがプラグインの設定画面から変更可能**。

## 2. 🧱 主な構成ファイルと機能

| ファイル | 概要 |
|---------|------|
| `main.ts` | プラグインのエントリーポイント。ObsidianのAPIと統合し、定期的にメモ分類を実行。 |
| `classify.ts` | Gemini APIを使って、メモの内容から最適なフォルダを判定する処理。 |
| `settings.ts` | プラグイン設定UIを提供。分類対象フォルダリストをユーザーが編集可能。 |
| `types.ts` | 設定値や分類結果の型定義など。 |

## 3. ⚙️ 設定（プラグインUI）

| 設定項目 | 内容 |
|----------|------|
| Gemini APIキー | ユーザーが入力（Google AI Studioで取得） |
| 分類対象フォルダ | `["技術メモ", "日記", "思考ログ"]` などを設定できる |
| 対象フォルダ | メモが保存されるルートフォルダ（例：`メモ/`） |

## 4. 🔁 処理の流れ

1. `メモ/` フォルダを監視（新規 or 定期チェック）
2. 各 `.md` ファイルを読み込み
   - タイトル（ファイル名）
   - 本文（最初の数百文字）
3. 設定画面で指定されたフォルダ一覧とともに Gemini に送信
4. Gemini からの返答に基づいて分類
   - 該当フォルダ名 → ファイル移動
   - 「分類しない」や該当なし → スキップ
5. 完了ログ出力（オプション）

## 5. 🤖 Gemini API プロンプト設計

```
あなたはフォルダ分類アシスタントです。

以下のフォルダ一覧から、このメモに最も適したものを1つ選んでください。
もしどれにも当てはまらなければ、「分類しない」としてください。

■ フォルダ一覧:
- 技術メモ
- 思考ログ
- 日記

■ メモのタイトル:
{title}

■ メモの本文:
{content}

出力形式（1行）:
- フォルダ名 または 「分類しない」
```

## 6. 📦 利用ライブラリ・前提環境

- TypeScript + Obsidian Plugin API
- Gemini 2.0 Flash API（REST）
- `fetch()` でAPI呼び出し
- `@codemirror/state`, `@obsidianmd/api` などの補助パッケージ（任意）

## 7. 📁 フォルダ構成（例）

```
my-plugin/
├─ main.ts
├─ classify.ts
├─ settings.ts
├─ types.ts
├─ manifest.json
```

## 8. 🚫 制限・注意点

- 無料枠でのGemini 2.0 Flashの利用には**レート制限やトークン制限**あり
- 分類精度はプロンプト次第。微調整が必要な場合あり
- Obsidianのファイル移動権限が必要

